{"ast":null,"code":"var _jsxFileName = \"/Users/kushki/Documents/Iniciativas_propias/Home_tasks/src/components/NotificationManager.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport Notification from './Notification';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst NotificationManager = ({\n  members,\n  tasks,\n  newTaskId\n}) => {\n  _s();\n  const [notifications, setNotifications] = useState([]);\n  const addNotification = (message, type = 'info') => {\n    const id = Date.now();\n    setNotifications(prev => [...prev, {\n      id,\n      message,\n      type\n    }]);\n    return id;\n  };\n  const removeNotification = id => {\n    setNotifications(prev => prev.filter(n => n.id !== id));\n  };\n  const sendNotification = async (member, message, methods) => {\n    try {\n      const response = await fetch('http://localhost:5050/api/notify', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          member,\n          message,\n          methods\n        })\n      });\n      if (response.ok) {\n        if (methods.whatsapp) addNotification(`WhatsApp enviado a ${member.name}`, 'success');\n        if (methods.email) addNotification(`Email enviado a ${member.name}`, 'success');\n      } else {\n        const error = await response.json();\n        addNotification(`Error al enviar notificación: ${error.error}`, 'error');\n      }\n    } catch (err) {\n      console.error(err);\n      addNotification('Error al conectar con el servidor de notificaciones', 'error');\n    }\n  };\n  useEffect(() => {\n    if (newTaskId) {\n      const task = tasks.find(t => t.id === newTaskId);\n      if (task) {\n        const member = members.find(m => m.id === task.assignedTo);\n        if (member) {\n          const message = `Nueva tarea asignada: ${task.title} para el ${new Date(task.startDate).toLocaleDateString()}. Recurrencia: cada ${task.recurrenceDays} días`;\n          sendNotification(member, message, task.notificationMethods);\n        }\n      }\n    }\n  }, [newTaskId, members, tasks]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: notifications.map(notification => /*#__PURE__*/_jsxDEV(Notification, {\n      message: notification.message,\n      type: notification.type\n    }, notification.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }, this))\n  }, void 0, false);\n};\n_s(NotificationManager, \"6gMUc0OfbF4zJu51/S5RmKCczuA=\");\n_c = NotificationManager;\nexport default NotificationManager;\nvar _c;\n$RefreshReg$(_c, \"NotificationManager\");","map":{"version":3,"names":["React","useState","useEffect","Notification","jsxDEV","_jsxDEV","Fragment","_Fragment","NotificationManager","members","tasks","newTaskId","_s","notifications","setNotifications","addNotification","message","type","id","Date","now","prev","removeNotification","filter","n","sendNotification","member","methods","response","fetch","method","headers","body","JSON","stringify","ok","whatsapp","name","email","error","json","err","console","task","find","t","m","assignedTo","title","startDate","toLocaleDateString","recurrenceDays","notificationMethods","children","map","notification","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/kushki/Documents/Iniciativas_propias/Home_tasks/src/components/NotificationManager.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport Notification from './Notification';\n\nconst NotificationManager = ({ members, tasks, newTaskId }) => {\n  const [notifications, setNotifications] = useState([]);\n\n  const addNotification = (message, type = 'info') => {\n    const id = Date.now();\n    setNotifications(prev => [...prev, { id, message, type }]);\n    return id;\n  };\n\n  const removeNotification = (id) => {\n    setNotifications(prev => prev.filter(n => n.id !== id));\n  };\n\n  const sendNotification = async (member, message, methods) => {\n    try {\n      const response = await fetch('http://localhost:5050/api/notify', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ member, message, methods }),\n      });\n\n      if (response.ok) {\n        if (methods.whatsapp) addNotification(`WhatsApp enviado a ${member.name}`, 'success');\n        if (methods.email) addNotification(`Email enviado a ${member.name}`, 'success');\n      } else {\n        const error = await response.json();\n        addNotification(`Error al enviar notificación: ${error.error}`, 'error');\n      }\n    } catch (err) {\n      console.error(err);\n      addNotification('Error al conectar con el servidor de notificaciones', 'error');\n    }\n  };\n\n  useEffect(() => {\n    if (newTaskId) {\n      const task = tasks.find(t => t.id === newTaskId);\n      if (task) {\n        const member = members.find(m => m.id === task.assignedTo);\n        if (member) {\n          const message = `Nueva tarea asignada: ${task.title} para el ${new Date(task.startDate).toLocaleDateString()}. Recurrencia: cada ${task.recurrenceDays} días`;\n          sendNotification(member, message, task.notificationMethods);\n        }\n      }\n    }\n  }, [newTaskId, members, tasks]);\n\n  return (\n    <>\n      {notifications.map(notification => (\n        <Notification\n          key={notification.id}\n          message={notification.message}\n          type={notification.type}\n        />\n      ))}\n    </>\n  );\n};\n\nexport default NotificationManager;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}