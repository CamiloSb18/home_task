{"ast":null,"code":"// utils/taskUtils.js\n\nconst MEMBERS_KEY = 'familytask_members';\nconst TASKS_KEY = 'familytask_tasks';\nexport function loadMembers() {\n  const data = localStorage.getItem(MEMBERS_KEY);\n  return data ? JSON.parse(data) : [];\n}\nexport function saveMembers(members) {\n  localStorage.setItem(MEMBERS_KEY, JSON.stringify(members));\n}\nexport function loadTasks() {\n  const data = localStorage.getItem(TASKS_KEY);\n  return data ? JSON.parse(data) : [];\n}\nexport function saveTasks(tasks) {\n  localStorage.setItem(TASKS_KEY, JSON.stringify(tasks));\n}\n\n// Nueva función para parsear fecha local sin problema de timezone\nfunction parseLocalDate(dateString) {\n  const [year, month, day] = dateString.split('-').map(Number);\n  return new Date(year, month - 1, day);\n}\nfunction formatDateLocal(date) {\n  const year = date.getFullYear();\n  const month = (date.getMonth() + 1).toString().padStart(2, '0');\n  const day = date.getDate().toString().padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\nexport function rotateAssignment(tasks, taskId, members) {\n  return tasks.map(task => {\n    if (task.id === taskId) {\n      var _members$nextMemberIn;\n      const currentStartDate = parseLocalDate(task.startDate);\n      const newStartDate = new Date(currentStartDate);\n      newStartDate.setDate(currentStartDate.getDate() + Number(task.recurrenceDays));\n      const currentMemberIndex = members.findIndex(m => m.id === task.assignedTo);\n      const nextMemberIndex = currentMemberIndex === -1 ? 0 : (currentMemberIndex + 1) % members.length;\n      return {\n        ...task,\n        assignedTo: ((_members$nextMemberIn = members[nextMemberIndex]) === null || _members$nextMemberIn === void 0 ? void 0 : _members$nextMemberIn.id) || null,\n        startDate: formatDateLocal(newStartDate) // <== Aquí la corrección\n      };\n    }\n    return task;\n  });\n}","map":{"version":3,"names":["MEMBERS_KEY","TASKS_KEY","loadMembers","data","localStorage","getItem","JSON","parse","saveMembers","members","setItem","stringify","loadTasks","saveTasks","tasks","parseLocalDate","dateString","year","month","day","split","map","Number","Date","formatDateLocal","date","getFullYear","getMonth","toString","padStart","getDate","rotateAssignment","taskId","task","id","_members$nextMemberIn","currentStartDate","startDate","newStartDate","setDate","recurrenceDays","currentMemberIndex","findIndex","m","assignedTo","nextMemberIndex","length"],"sources":["/Users/kushki/Documents/Iniciativas_propias/Home_tasks/src/utils/taskUtils.js"],"sourcesContent":["// utils/taskUtils.js\n\nconst MEMBERS_KEY = 'familytask_members';\nconst TASKS_KEY = 'familytask_tasks';\n\nexport function loadMembers() {\n  const data = localStorage.getItem(MEMBERS_KEY);\n  return data ? JSON.parse(data) : [];\n}\n\nexport function saveMembers(members) {\n  localStorage.setItem(MEMBERS_KEY, JSON.stringify(members));\n}\n\nexport function loadTasks() {\n  const data = localStorage.getItem(TASKS_KEY);\n  return data ? JSON.parse(data) : [];\n}\n\nexport function saveTasks(tasks) {\n  localStorage.setItem(TASKS_KEY, JSON.stringify(tasks));\n}\n\n// Nueva función para parsear fecha local sin problema de timezone\nfunction parseLocalDate(dateString) {\n  const [year, month, day] = dateString.split('-').map(Number);\n  return new Date(year, month - 1, day);\n}\n\nfunction formatDateLocal(date) {\n  const year = date.getFullYear();\n  const month = (date.getMonth() + 1).toString().padStart(2, '0');\n  const day = date.getDate().toString().padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\nexport function rotateAssignment(tasks, taskId, members) {\n  return tasks.map(task => {\n    if (task.id === taskId) {\n      const currentStartDate = parseLocalDate(task.startDate);\n      const newStartDate = new Date(currentStartDate);\n      newStartDate.setDate(currentStartDate.getDate() + Number(task.recurrenceDays));\n\n      const currentMemberIndex = members.findIndex(m => m.id === task.assignedTo);\n      const nextMemberIndex = currentMemberIndex === -1 ? 0 : (currentMemberIndex + 1) % members.length;\n\n      return {\n        ...task,\n        assignedTo: members[nextMemberIndex]?.id || null,\n        startDate: formatDateLocal(newStartDate),  // <== Aquí la corrección\n      };\n    }\n    return task;\n  });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}